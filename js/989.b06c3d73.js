"use strict";(self["webpackChunkgreatest_work"]=self["webpackChunkgreatest_work"]||[]).push([[989],{1989:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var i=a(3396);const l={class:"layout_main"},o=(0,i.Uk)(" 新增站点 "),d=(0,i.Uk)(" 编译中 "),n=(0,i.Uk)(" 正常运行 "),m=(0,i.Uk)("构建"),s=(0,i.Uk)("编辑"),u=(0,i.Uk)("删除");function p(e,t,a,p,r,c){const f=(0,i.up)("icon-plus"),w=(0,i.up)("a-button"),k=(0,i.up)("a-space"),g=(0,i.up)("icon-refresh"),b=(0,i.up)("icon-check-circle"),y=(0,i.up)("a-table"),W=(0,i.up)("a-input"),_=(0,i.up)("a-form-item"),v=(0,i.up)("a-form"),h=(0,i.up)("a-modal");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",l,[(0,i.Wm)(k,{style:{margin:"10px 0"}},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{onClick:t[0]||(t[0]=e=>p.openModel("add")),type:"primary"},{icon:(0,i.w5)((()=>[(0,i.Wm)(f)])),default:(0,i.w5)((()=>[o])),_:1})])),_:1}),(0,i.Wm)(y,{bordered:!1,loading:p.loading,columns:p.columns,data:p.data.site},{status:(0,i.w5)((({record:e})=>[0===e.status?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Wm)(g,{spin:""}),d],64)):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Wm)(b,{style:{color:"#00b52b"}}),n],64))])),optional:(0,i.w5)((({record:e})=>[(0,i.Wm)(w,{type:"text",onClick:t=>p.startBuildSite(e.id)},{default:(0,i.w5)((()=>[m])),_:2},1032,["onClick"]),(0,i.Wm)(w,{type:"text",onClick:t=>p.editSite(e)},{default:(0,i.w5)((()=>[s])),_:2},1032,["onClick"]),(0,i.Wm)(w,{type:"text",onClick:t=>p.toDeleteSite(e.id),status:"danger"},{default:(0,i.w5)((()=>[u])),_:2},1032,["onClick"])])),_:1},8,["loading","columns","data"])]),(0,i.Wm)(h,{visible:p.visible,"onUpdate:visible":t[5]||(t[5]=e=>p.visible=e),onOk:p.submitForm,title:p.modelTitle()},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{model:p.data.form},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{field:"name",label:"站点名称"},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{modelValue:p.data.form.name,"onUpdate:modelValue":t[1]||(t[1]=e=>p.data.form.name=e)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(_,{rules:[{type:"url"}],field:"siteLink",label:"网站地址"},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{modelValue:p.data.form.siteLink,"onUpdate:modelValue":t[2]||(t[2]=e=>p.data.form.siteLink=e)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(_,{field:"path",label:"根目录地址"},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{modelValue:p.data.form.path,"onUpdate:modelValue":t[3]||(t[3]=e=>p.data.form.path=e)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(_,{rules:[{type:"email"}],field:"admin",label:"管理员邮箱"},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{modelValue:p.data.form.admin,"onUpdate:modelValue":t[4]||(t[4]=e=>p.data.form.admin=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","onOk","title"])],64)}var r=a(4870);const c=[{title:"站点名称",dataIndex:"name",ellipsis:!0,tooltip:!0},{title:"站点地址",dataIndex:"siteLink",tooltip:!0,ellipsis:!0},{title:"站点根路径",dataIndex:"path",tooltip:!0,ellipsis:!0},{title:"文章数量（篇）",dataIndex:"articleTotal",tooltip:!0,align:"right",ellipsis:!0},{title:"状态",dataIndex:"status",slotName:"status",ellipsis:!0,align:"center"},{title:"创建时间",dataIndex:"createTime",tooltip:!0,ellipsis:!0},{title:"更新时间",dataIndex:"updateTime",tooltip:!0,ellipsis:!0},{title:"操作",width:240,slotName:"optional",align:"center"}];var f=a(6624),w=a(9049),k={name:"site-list",setup(){const e={y:400},{getSiteList:t,buildSite:a,deleteSite:l,updateSite:o,addSite:d}=(0,i.f3)("api"),n=(0,r.iH)(!0),m=(0,r.iH)(!1),s=(0,r.qj)({site:[],pagination:{pageSize:10,total:0},form:{name:"",siteLink:"",path:"",admin:""},type:"add"});(0,i.bv)((async()=>{await g()}));const u=()=>"add"===s.type,p=()=>(u()?"新增":"编辑")+"站点",k=async()=>{u()?await d(s.form):await o(s.form),await g()},g=async(e=1)=>{n.value=!0;const a={pageSize:s.pagination.pageSize,page:e},{items:i,total:l}=await t(a);i.forEach((e=>{e.createTime=(0,w.U)(e.createTime),e.updateTime=(0,w.U)(e.updateTime)})),s.site=i,s.pagination.total=l,n.value=!1},b=async e=>{await a(e),await g()},y=e=>{f.Z.warning({title:"温馨提示",content:"确定删除这个站点吗？继续将无法找回","on-before-ok":async function(t){await l(e),await g(),t()}})},W=e=>{s.form={name:"",siteLink:"",path:"",admin:""},s.type=e,m.value=!0},_=e=>{W("edit"),s.form={...e}};return{columns:c,loading:n,data:s,getList:g,scroll:e,visible:m,submitForm:k,startBuildSite:b,toDeleteSite:y,editSite:_,modelTitle:p,openModel:W}}},g=a(89);const b=(0,g.Z)(k,[["render",p],["__scopeId","data-v-5eac032e"]]);var y=b}}]);