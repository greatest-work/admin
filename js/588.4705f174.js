"use strict";(self["webpackChunkgreatest_work"]=self["webpackChunkgreatest_work"]||[]).push([[588],{4710:function(e,t,a){a.d(t,{Ec:function(){return u},dg:function(){return i},fb:function(){return o}});const s=()=>[{label:"未发布",value:0,status:"processing"},{label:"已发布",value:1,status:"success"},{label:"发布中",value:2,status:"warning"}],l=()=>[{label:"初始化完成",value:0,status:"processing"},{label:"正常运行中",value:1,status:"success"},{label:"编译中",value:2,status:"warning"}],n=()=>[{label:"未上线",value:0,status:"processing"},{label:"正常运行",value:1,status:"success"},{label:"已下线",value:2,status:"warning"}],i=e=>l().find((t=>t.value===e)),u=e=>s().find((t=>t.value===e)),o=e=>n().find((t=>t.value===e))},4107:function(e,t,a){a.d(t,{Yp:function(){return n},jQ:function(){return l},zF:function(){return s}});const s=[{title:"标题",dataIndex:"title",ellipsis:!0,tooltip:!0},{title:"是否发布",width:100,align:"center",slotName:"status"},{title:"标签",slotName:"tag"},{title:"所属站点",dataIndex:"siteInfo.name"},{title:"更新时间",dataIndex:"updateTime",ellipsis:!0,tooltip:!0},{width:200,title:"操作",slotName:"optional",align:"center"}],l=()=>({title:[{required:!0,message:"标题必填"},{minLength:5,message:"标题长度不能少于 5 个字符"},{maxLength:100,message:"标题长度不能多于 100 个字符"}],siteId:[{required:!0,message:"发布站点必填"}],content:[{required:!0,message:"内容站点必填"},{minLength:20,message:"内容长度不能少于 20 个字符"},{maxLength:2e4,message:"内容长度不能多于 20k 个字符"}],tags:[{required:!0,message:"至少选择一个标签"}],userId:[{required:!0,message:"请选择作者"}]}),n=()=>({siteList:{value:"id",label:"name"},userList:{value:"id",label:"username"}})},7588:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var s=a(3396),l=a(7139);const n={class:"layout_main"},i=(0,s.Uk)(" 新增文章 "),u=(0,s.Uk)("编辑"),o=(0,s.Uk)("删除");function g(e,t,a,g,r,c){const d=(0,s.up)("icon-plus"),m=(0,s.up)("a-button"),p=(0,s.up)("a-space"),w=(0,s.up)("a-badge"),f=(0,s.up)("a-tag"),v=(0,s.up)("a-tooltip"),b=(0,s.up)("a-table");return(0,s.wg)(),(0,s.iD)("div",n,[(0,s.Wm)(p,{style:{margin:"10px 0"}},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{onClick:t[0]||(t[0]=e=>g.openModel("add")),type:"primary"},{icon:(0,s.w5)((()=>[(0,s.Wm)(d)])),default:(0,s.w5)((()=>[i])),_:1})])),_:1}),(0,s.Wm)(b,{scroll:g.scroll,bordered:!1,loading:g.loading,columns:g.columns,data:g.data.articles,pagination:g.data.pagination,onPageChange:g.getList,onPageSizeChange:g.getList},{status:(0,s.w5)((({record:e})=>[(0,s.Wm)(w,{status:g.getArticleStatus(e.status).status,text:g.getArticleStatus(e.status).label},null,8,["status","text"])])),tag:(0,s.w5)((({record:e})=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(g.getColumusTags(e),((e,t)=>((0,s.wg)(),(0,s.iD)(s.HY,null,[t<g.maxTagNum?((0,s.wg)(),(0,s.j4)(f,{size:"small",key:e},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e),1)])),_:2},1024)):(0,s.kq)("",!0)],64)))),256)),g.getColumusTags(e).length>g.maxTagNum?((0,s.wg)(),(0,s.j4)(f,{key:0,size:"small"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{content:g.getTagsTipContent(e)},{default:(0,s.w5)((()=>[(0,s._)("span",null," + "+(0,l.zw)(g.getColumusTags(e).length-g.maxTagNum),1)])),_:2},1032,["content"])])),_:2},1024)):(0,s.kq)("",!0)])),_:2},1024)])),optional:(0,s.w5)((({record:e})=>[(0,s.Wm)(m,{type:"text",onClick:t=>g.openModel("edit",e.id)},{default:(0,s.w5)((()=>[u])),_:2},1032,["onClick"]),(0,s.Wm)(m,{type:"text",onClick:t=>g.deleteArticle(e.id),status:"danger"},{default:(0,s.w5)((()=>[o])),_:2},1032,["onClick"])])),_:1},8,["scroll","loading","columns","data","pagination","onPageChange","onPageSizeChange"])])}var r=a(4870),c=a(4107),d=a(4710),m=a(2483),p=a(9049),w=a(6624),f={name:"article-list",setup(){const e={y:600},{getArticlesList:t,delArticle:a}=(0,s.f3)("api"),l=(0,m.tv)(),n=(0,r.iH)(!0),i=(0,r.qj)({articles:[],pagination:{pageSize:10,total:0,"show-total":!0}}),u=(0,r.qj)({list:[]});(0,s.bv)((async()=>{await o()}));const o=async(e=1)=>{n.value=!0;const a={pageSize:i.pagination.pageSize,page:e},{items:s,total:l}=await t(a);s.forEach((e=>{e.createTime=(0,p.U)(e.createTime),e.updateTime=(0,p.U)(e.updateTime)})),i.articles=s,i.pagination.total=l,n.value=!1},g=(0,r.iH)(2),f=({tags:e})=>e?.split(",")??[],v=e=>{const t=f(e);return t?.splice(g.value,t?.length).join(",")},b=async e=>{w.Z.warning({title:"温馨提示",content:"确定删除这篇文章吗？继续将无法找回","on-before-ok":async function(t){await a(e),await o(),t()}})},k=(e,t)=>{console.log(e),l.push({path:"/article/edit",query:{type:e,id:t}})};return{columns:c.zF,loading:n,data:i,scroll:e,site:u,getArticleStatus:d.Ec,getList:o,deleteArticle:b,openModel:k,maxTagNum:g,getColumusTags:f,getTagsTipContent:v}}},v=a(89);const b=(0,v.Z)(f,[["render",g],["__scopeId","data-v-6217a4c1"]]);var k=b}}]);