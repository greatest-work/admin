"use strict";(self["webpackChunkgreatest_work"]=self["webpackChunkgreatest_work"]||[]).push([[532],{6532:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var i=a(3396),l=a(7139);const o={class:"layout_main"},n=(0,i.Uk)(" 新增站点 "),d=(0,i.Uk)(" 编译中 "),s=(0,i.Uk)(" 正常运行 "),m=(0,i.Uk)("构建"),u=(0,i.Uk)("编辑"),r=(0,i.Uk)("删除");function p(e,t,a,p,c,f){const k=(0,i.up)("icon-plus"),w=(0,i.up)("a-button"),g=(0,i.up)("a-space"),b=(0,i.up)("a-link"),y=(0,i.up)("icon-refresh"),W=(0,i.up)("icon-check-circle"),_=(0,i.up)("a-table"),h=(0,i.up)("a-input"),v=(0,i.up)("a-form-item"),S=(0,i.up)("a-form"),U=(0,i.up)("a-modal");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",o,[(0,i.Wm)(g,{style:{margin:"10px 0"}},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{onClick:t[0]||(t[0]=e=>p.openModel("add")),type:"primary"},{icon:(0,i.w5)((()=>[(0,i.Wm)(k)])),default:(0,i.w5)((()=>[n])),_:1})])),_:1}),(0,i.Wm)(_,{bordered:!1,loading:p.loading,columns:p.columns,data:p.data.site},{siteInfo:(0,i.w5)((({record:e})=>[(0,i.Wm)(b,{href:"#/site/detail/"+e.id},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.name),1)])),_:2},1032,["href"])])),siteLink:(0,i.w5)((({record:e})=>[(0,i.Wm)(b,{href:e.siteLink,target:"_blank"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.siteLink),1)])),_:2},1032,["href"])])),status:(0,i.w5)((({record:e})=>[0===e.status?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Wm)(y,{spin:""}),d],64)):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Wm)(W,{style:{color:"#00b52b"}}),s],64))])),optional:(0,i.w5)((({record:e})=>[(0,i.Wm)(w,{type:"text",onClick:t=>p.startBuildSite(e.id)},{default:(0,i.w5)((()=>[m])),_:2},1032,["onClick"]),(0,i.Wm)(w,{type:"text",onClick:t=>p.editSite(e)},{default:(0,i.w5)((()=>[u])),_:2},1032,["onClick"]),(0,i.Wm)(w,{type:"text",onClick:t=>p.toDeleteSite(e.id),status:"danger"},{default:(0,i.w5)((()=>[r])),_:2},1032,["onClick"])])),_:1},8,["loading","columns","data"])]),(0,i.Wm)(U,{visible:p.visible,"onUpdate:visible":t[5]||(t[5]=e=>p.visible=e),onOk:p.submitForm,title:p.modelTitle()},{default:(0,i.w5)((()=>[(0,i.Wm)(S,{model:p.data.form},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{field:"name",label:"站点名称"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:p.data.form.name,"onUpdate:modelValue":t[1]||(t[1]=e=>p.data.form.name=e)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(v,{rules:[{type:"url"}],field:"siteLink",label:"网站地址"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:p.data.form.siteLink,"onUpdate:modelValue":t[2]||(t[2]=e=>p.data.form.siteLink=e)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(v,{field:"path",label:"根目录地址"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:p.data.form.path,"onUpdate:modelValue":t[3]||(t[3]=e=>p.data.form.path=e)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(v,{rules:[{type:"email"}],field:"admin",label:"管理员邮箱"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:p.data.form.admin,"onUpdate:modelValue":t[4]||(t[4]=e=>p.data.form.admin=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","onOk","title"])],64)}var c=a(4870);const f=[{title:"站点名称",dataIndex:"name",slotName:"siteInfo",ellipsis:!0},{title:"站点地址",dataIndex:"siteLink",slotName:"siteLink",ellipsis:!0},{title:"文章数量（篇）",dataIndex:"articleTotal",tooltip:!0,align:"center",ellipsis:!0},{title:"状态",dataIndex:"status",slotName:"status",ellipsis:!0,align:"center"},{title:"创建时间",dataIndex:"createTime",tooltip:!0,ellipsis:!0},{title:"更新时间",dataIndex:"updateTime",tooltip:!0,ellipsis:!0},{title:"操作",width:240,slotName:"optional",align:"center"}];var k=a(6624),w=a(2483),g=a(9049),b={name:"site-list",setup(){const e={y:400},t=(0,w.tv)(),{getSiteList:a,buildSite:l,deleteSite:o,updateSite:n,addSite:d}=(0,i.f3)("api"),s=(0,c.iH)(!0),m=(0,c.iH)(!1),u=(0,c.qj)({site:[],pagination:{pageSize:10,total:0},form:{name:"",siteLink:"",path:"",admin:""},type:"add"});(0,i.bv)((async()=>{await y()}));const r=()=>"add"===u.type,p=()=>(r()?"新增":"编辑")+"站点",b=async()=>{r()?await d(u.form):await n(u.form),await y()},y=async(e=1)=>{s.value=!0;const t={pageSize:u.pagination.pageSize,page:e},{items:i,total:l}=await a(t);i.forEach((e=>{e.createTime=(0,g.U)(e.createTime),e.updateTime=(0,g.U)(e.updateTime)})),u.site=i,u.pagination.total=l,s.value=!1},W=async e=>{await l(e),await y()},_=e=>{k.Z.warning({title:"温馨提示",content:"确定删除这个站点吗？继续将无法找回","on-before-ok":async function(t){await o(e),await y(),t()}})},h=e=>{u.form={name:"",siteLink:"",path:"",admin:""},u.type=e,m.value=!0},v=e=>{h("edit"),u.form={...e}},S=e=>{console.log(e),t.push({path:`/site/detail/${e}`})};return{columns:f,loading:s,data:u,getList:y,scroll:e,visible:m,submitForm:b,startBuildSite:W,toDeleteSite:_,editSite:v,modelTitle:p,openModel:h,getSiteInfo:S}}},y=a(89);const W=(0,y.Z)(b,[["render",p],["__scopeId","data-v-3b0a129d"]]);var _=W}}]);